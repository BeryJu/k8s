apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../common/helm/metallb.yaml
patchesStrategicMerge:
  - |-
    apiVersion: helm.toolkit.fluxcd.io/v2beta1
    kind: HelmRelease
    metadata:
      name: metallb
      namespace: metallb-system
    spec:
      values:
        configInline:
          peers:
          - peer-address: "10.120.20.1"
            peer-asn: 204662
            my-asn: 65553
          address-pools:
          - name: default
            protocol: bgp
            avoid-buggy-ips: true
            addresses:
            - "10.120.21.0/28"
