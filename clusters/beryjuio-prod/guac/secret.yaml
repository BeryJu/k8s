apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: guac-values
  namespace: guac
spec:
  secretStoreRef:
    name: vault-kv
    kind: ClusterSecretStore
  target:
    template:
      data:
        values.yaml: |
          postgres:
            hostname: "postgres-postgresql"
            password: "{% .Secrets.root_password %}"
            user: guacamole
  data:
    - secretKey: root_password
      remoteRef:
        key: kv/services/guac/postgres
        property: root_password
