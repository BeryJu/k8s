apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: beryjuorg-postgresql-chart
  namespace: guac
spec:
  secretStoreRef:
    name: vault-kv
    kind: ClusterSecretStore
  target:
    template:
      data:
        values.yaml: |
          global:
            postgresql:
              auth:
                postgresPassword: "{{ .pg_password }}"
                password: "{{ .root_password }}"
                replicationPassword: ""
                ldapPassword: ""
        postgres-password: "{{ .pg_password }}"
        password: "{{ .root_password }}"
        replication-password: ""
        ldap-password: ""
  data:
    - secretKey: root_password
      remoteRef:
        key: kv/services/guac/postgres
        property: root_password
    - secretKey: pg_password
      remoteRef:
        key: kv/services/guac/postgres
        property: pg_password
